# 卒業論文執筆のために作成したコード


# 各ソースコードについて

**・optimize_biquad_filter.m**

HRTFの概形をearlyHRTFによってとらえ、これの低周波側から一つ目のピーク,２つめのノッチ、３つ目ノッチについて、それぞれの形を再現した双二次フィルタを作成するコード
双二次フィルタのパラメータは/numsに保存する。

**・classificate_pk.m**

ピークやノッチに適応した双二次フィルタのパラメータ(中心周波数、ゲイン、バンド幅)を、仰角についての関数として表現するためのコード。
この関数の係数は/parametersに保存される。

**・convoice_parametricHRTF**

上記二つのコードを用いて得た関数を用いて任意の仰角のHRTFを推定し、これによって移動音源を合成するコード。
合成した音源は/soundsに保存される。

**・plot_parametricHRTF**

最初の二つのコードで推定したHRTFと実測HRTFをプロットするコード
図は/graphに保存される


**・convoice_linearHRTF**

HRTFを線形補間し、移動音源を合成するコード。
合成した音源は/soundsに保存される

**・plot_linearHRTF**

線形補間したHRTFと補間に用いた実測HRTFをプロットするコード


# 卒業論文の概要


真正面から真後ろまで(仰角0°~180°)10°刻みで存在する実測HRTFを補間して移動音源を合成するコードです。
補間手法は2種類あります。

**・補間手法１**

HRTFを大まかなピークやノッチごとに分解して、これらを仰角についての関数として表現することで、任意の角度のHRTFを得られるようにする手法
音の到来方向の近くにおいては低い周波数から数えて、1つ目のピークと1つ目のノッチ、2つ目のノッチが重要だとされていることに基づいています。
フローは以下のようになっています。

1:HRTFを概形で近似

2:概形において、低い周波数から一つ目のピーク(P1)と１，２，３つ目のノッチ(N1,N2,N3)それぞれを近似した双二次フィルタを得る
  また、この双二次フィルタは(ゲイン，バンド幅、中心周波数)の３つのパラメータで表現される。

3:0°～180°の仰角で2を行い、これらの仰角それぞれについて3つのパラメータを得る。

4:それぞれのパラメータを仰角についての関数として10次関数で近似する

これにより、任意の仰角のピークやノッチのパラメータを取得できるようになり、HRTFを推定できるという手法です。また、以下の画像にてこの手法を概説しています。
![手法1説明-1](https://github.com/ribe26/bachelor_thesis/assets/106515205/e525a3fb-f9d3-4ead-99bc-518373dbdb4d)
![手法1説明-2](https://github.com/ribe26/bachelor_thesis/assets/106515205/6cf5c78e-6752-42ef-aa5c-c0b179cd5dec)

**補間手法２**

2つのHRTFの振幅と位相を線形に補間する手法
表現したい仰角を挟むように実測HRTFを用意し、この仰角が実測HRTFの仰角をどのように内分するかで重みづけを決め、
これに基づいて二つのHRTFから間に位置する所望の仰角のHRTFを推定する手法です。
以下の画像にてこの手法を概説しています。
![手法2説明-1](https://github.com/ribe26/bachelor_thesis/assets/106515205/51b41d70-1f03-4abf-b870-9c7e757d551c)
![手法2説明-2](https://github.com/ribe26/bachelor_thesis/assets/106515205/f2904e00-46e4-45bb-89b9-96773d6acca4)
